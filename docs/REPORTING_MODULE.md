# –ú–æ–¥—É–ª—å –û—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ (Reporting Module)

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
3. [–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫-–¥–∞–Ω–Ω—ã—Ö)
4. [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ-–∑–∞–¥–∞—á–∏)
5. [REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#rest-api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
6. [–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤](#—ç–∫—Å–ø–æ—Ä—Ç-–æ—Ç—á–µ—Ç–æ–≤)
7. [Email —Ä–∞—Å—Å—ã–ª–∫–∞](#email-—Ä–∞—Å—Å—ã–ª–∫–∞)

---

## üéØ –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–ª—å—é. –ú–æ–¥—É–ª—å –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ MongoDB (AnalyticsEvent) –≤ PostgreSQL –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç—ã –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (MongoDB ‚Üí PostgreSQL)
- ‚úÖ REST API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel (.xlsx) –∏ PDF —Ñ–æ—Ä–º–∞—Ç—ã
- ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏
- ‚úÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π MongoDB (30-–¥–Ω–µ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```
reporting/
‚îú‚îÄ‚îÄ entity/
‚îÇ   ‚îú‚îÄ‚îÄ DailyReportAggregate.java      # –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ WeeklyReportAggregate.java     # –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–±—É–¥—É—â–µ–µ)
‚îÇ   ‚îî‚îÄ‚îÄ MonthlyReportAggregate.java    # –ï–∂–µ–º–µ—Å—è—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–±—É–¥—É—â–µ–µ)
‚îú‚îÄ‚îÄ repository/
‚îÇ   ‚îú‚îÄ‚îÄ DailyReportRepository.java
‚îÇ   ‚îú‚îÄ‚îÄ WeeklyReportRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ MonthlyReportRepository.java
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ DataAggregationService.java    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ ExcelExportService.java        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel
‚îÇ   ‚îú‚îÄ‚îÄ PdfExportService.java          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF
‚îÇ   ‚îî‚îÄ‚îÄ EmailReportService.java        # –û—Ç–ø—Ä–∞–≤–∫–∞ email
‚îî‚îÄ‚îÄ controller/
    ‚îî‚îÄ‚îÄ ReportController.java          # REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
```

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**PostgreSQL (H2 –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**
- `daily_report_aggregates` - –•—Ä–∞–Ω–∏—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

**MongoDB:**
- `analytics_events` - –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–π (30-–¥–Ω–µ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ)

---

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### 1. –°–±–æ—Ä —Å–æ–±—ã—Ç–∏–π (Real-time)
```
–î–µ–π—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí AnalyticsEvent ‚Üí MongoDB
```

**–¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π:**
- `PATIENT_REGISTERED` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞
- `VAS_RECORDED` - –ó–∞–ø–∏—Å—å —É—Ä–æ–≤–Ω—è –±–æ–ª–∏ –ø–æ —à–∫–∞–ª–µ VAS
- `RECOMMENDATION_GENERATED` - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `RECOMMENDATION_APPROVED` - –û–¥–æ–±—Ä–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `RECOMMENDATION_REJECTED` - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- `ESCALATION_CREATED` - –°–æ–∑–¥–∞–Ω–∏–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
- `ESCALATION_RESOLVED` - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
- `USER_LOGIN_SUCCESS` - –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
- `USER_LOGIN_FAILED` - –ù–µ—É–¥–∞—á–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞

### 2. –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è (–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
```
MongoDB (AnalyticsEvent) ‚Üí DataAggregationService ‚Üí PostgreSQL (DailyReportAggregate)
```

**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:30 (cron: `0 30 0 * * *`)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –∏–∑ MongoDB –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å
2. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –ø–æ —Ç–∏–ø–∞–º
3. –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (—Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è, –ø–æ–¥—Å—á–µ—Ç—ã, –ø—Ä–æ—Ü–µ–Ω—Ç—ã)
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL
5. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Å–æ–±—ã—Ç–∏–π MongoDB (>30 –¥–Ω–µ–π)

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ (–ü–æ –∑–∞–ø—Ä–æ—Å—É)
```
API –∑–∞–ø—Ä–æ—Å ‚Üí DailyReportRepository ‚Üí Export Service ‚Üí –û—Ç–≤–µ—Ç (JSON/Excel/PDF)
```

### 4. –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ Email (–ü–æ –∑–∞–ø—Ä–æ—Å—É –∏–ª–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
```
API –∑–∞–ø—Ä–æ—Å ‚Üí EmailReportService ‚Üí SMTP —Å–µ—Ä–≤–µ—Ä ‚Üí –ü–æ–ª—É—á–∞—Ç–µ–ª—å
```

---

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏

### –ó–∞–¥–∞—á–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
**–ö–ª–∞—Å—Å:** `DataAggregationService.aggregateDailyData()`  
**–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:** `@Scheduled(cron = "0 30 0 * * *")` - –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:30  
**–§—É–Ω–∫—Ü–∏—è:**
- –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å `DailyReportAggregate`
- –û—á–∏—â–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è MongoDB —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```java
@EnableScheduling  // –í AsyncConfig.java
```

---

## üåê REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤

#### –ü–æ–ª—É—á–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –∑–∞ –ø–µ—Ä–∏–æ–¥
```http
GET /api/reports/daily?startDate=2025-10-01&endDate=2025-10-19
```

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 1,
    "reportDate": "2025-10-18",
    "totalPatientsRegistered": 15,
    "totalVasRecords": 120,
    "averageVasLevel": 4.5,
    "criticalVasCount": 8,
    "totalRecommendations": 45,
    "approvedRecommendations": 38,
    "rejectedRecommendations": 7,
    "approvalRate": 84.44,
    "totalEscalations": 5,
    "resolvedEscalations": 3,
    "pendingEscalations": 2,
    "averageResolutionTimeHours": 2.5,
    "totalLogins": 67,
    "uniqueActiveUsers": 23,
    "createdAt": "2025-10-19T00:35:00"
  }
]
```

#### –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É
```http
GET /api/reports/daily/2025-10-18
```

#### –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç—á–µ—Ç—ã
```http
GET /api/reports/daily/recent?limit=7
```

#### –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```http
GET /api/reports/summary?startDate=2025-10-01&endDate=2025-10-19
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "period": {
    "startDate": "2025-10-01",
    "endDate": "2025-10-19",
    "daysCount": 19
  },
  "patients": {
    "totalRegistered": 285,
    "totalVasRecords": 2280,
    "averageVasLevel": 4.32
  },
  "recommendations": {
    "total": 855,
    "approved": 722,
    "rejected": 133,
    "approvalRate": 84.44
  },
  "escalations": {
    "total": 95,
    "resolved": 57,
    "pending": 38
  },
  "users": {
    "totalLogins": 1273,
    "uniqueActiveUsers": 45
  }
}
```

### 2. –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤

#### –≠–∫—Å–ø–æ—Ä—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –≤ Excel
```http
GET /api/reports/daily/2025-10-18/export/excel
```
**–û—Ç–≤–µ—Ç:** –§–∞–π–ª `daily_report_2025-10-18.xlsx`

#### –≠–∫—Å–ø–æ—Ä—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –≤ PDF
```http
GET /api/reports/daily/2025-10-18/export/pdf
```
**–û—Ç–≤–µ—Ç:** –§–∞–π–ª `daily_report_2025-10-18.pdf`

#### –≠–∫—Å–ø–æ—Ä—Ç —Å–≤–æ–¥–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤ Excel
```http
GET /api/reports/export/excel?startDate=2025-10-01&endDate=2025-10-19
```
**–û—Ç–≤–µ—Ç:** –§–∞–π–ª `reports_summary_2025-10-01_to_2025-10-19.xlsx`

#### –≠–∫—Å–ø–æ—Ä—Ç —Å–≤–æ–¥–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ –≤ PDF
```http
GET /api/reports/export/pdf?startDate=2025-10-01&endDate=2025-10-19
```
**–û—Ç–≤–µ—Ç:** –§–∞–π–ª `reports_summary_2025-10-01_to_2025-10-19.pdf`

### 3. Email —Ä–∞—Å—Å—ã–ª–∫–∞

#### –û—Ç–ø—Ä–∞–≤–∏—Ç—å –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ email
```http
POST /api/reports/daily/2025-10-18/email?email=admin@example.com&attachPdf=true&attachExcel=true
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "message": "Email is being sent to admin@example.com",
  "date": "2025-10-18"
}
```

#### –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ email
```http
POST /api/reports/email/summary?startDate=2025-10-01&endDate=2025-10-19&email=admin@example.com
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "success",
  "message": "Summary email is being sent to admin@example.com",
  "startDate": "2025-10-01",
  "endDate": "2025-10-19",
  "reportsCount": "19"
}
```

### 4. –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤

#### –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É
```http
POST /api/reports/daily/generate?date=2025-10-18&regenerate=false
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `date` - –î–∞—Ç–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞
- `regenerate` - –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é false)

### 5. Health Check

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–æ–¥—É–ª—è
```http
GET /api/reports/health
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "status": "UP",
  "module": "Reporting",
  "totalReports": 150,
  "latestReportDate": "2025-10-18",
  "timestamp": "2025-10-19"
}
```

---

## üìä –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤

### Excel Export (Apache POI 5.2.3)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ª–∏—Å—Ç–æ–≤

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:** `.xlsx` (Excel 2007+)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç—á–µ—Ç–∞:**
1. –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –¥–∞—Ç–æ–π
2. –°–µ–∫—Ü–∏—è "PATIENT STATISTICS"
3. –°–µ–∫—Ü–∏—è "RECOMMENDATION STATISTICS"
4. –°–µ–∫—Ü–∏—è "ESCALATION STATISTICS"
5. –°–µ–∫—Ü–∏—è "SYSTEM PERFORMANCE"
6. –°–µ–∫—Ü–∏—è "USER ACTIVITY"

### PDF Export (Apache PDFBox 3.0.0)

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –§—É—Ç–µ—Ä —Å –¥–∞—Ç–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —à—Ä–∏—Ñ—Ç–æ–≤

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:** `.pdf`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –§–æ—Ä–º–∞—Ç A4
- –®—Ä–∏—Ñ—Ç: Helvetica
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–Ω–æ—Å –Ω–∞ –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –º–µ—Å—Ç–∞

---

## üìß Email —Ä–∞—Å—Å—ã–ª–∫–∞

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è SMTP

**–§–∞–π–ª:** `application.properties`

```properties
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=your-email@gmail.com
spring.mail.password=your-app-password
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
```

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Email —Å–µ—Ä–≤–∏—Å–∞

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `@Async` –¥–ª—è –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ù–µ –∑–∞–º–µ–¥–ª—è–µ—Ç API –æ—Ç–≤–µ—Ç—ã

**HTML —à–∞–±–ª–æ–Ω—ã:**
- –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø–∏—Å–µ–º
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞
- –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π

**–í–ª–æ–∂–µ–Ω–∏—è:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ PDF
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ Excel
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–ª–æ–∂–µ–Ω–∏–π

**–¢–∏–ø—ã –ø–∏—Å–µ–º:**
1. **Daily Report Email** - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π
2. **Summary Report Email** - –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**Backend:**
- Spring Boot 3.5.5
- Spring Data JPA (PostgreSQL/H2)
- Spring Data MongoDB
- Spring Mail
- Spring Scheduling

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
- Apache POI 5.2.3 (Excel)
- Apache PDFBox 3.0.0 (PDF)
- Lombok (—É–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞)
- Jackson (JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**AsyncConfig.java:**
```java
@Configuration
@EnableAsync
@EnableScheduling
public class AsyncConfig {
    // –í–∫–ª—é—á–∞–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á
}
```

### Retention Policy

**MongoDB —Å–æ–±—ã—Ç–∏—è:**
- –•—Ä–∞–Ω—è—Ç—Å—è 30 –¥–Ω–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏
- –ú–µ—Ç–æ–¥: `DataAggregationService.cleanupOldEvents(30)`

**PostgreSQL –æ—Ç—á–µ—Ç—ã:**
- –•—Ä–∞–Ω—è—Ç—Å—è –±–µ—Å—Å—Ä–æ—á–Ω–æ
- –ú–æ–≥—É—Ç –±—ã—Ç—å —É–¥–∞–ª–µ–Ω—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ API (–±—É–¥—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è)

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –≤ –æ—Ç—á–µ—Ç–∞—Ö

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
- **Total Patients Registered** - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
- **Total VAS Records** - –ó–∞–ø–∏—Å–µ–π –∏–∑–º–µ—Ä–µ–Ω–∏–π –±–æ–ª–∏
- **Average VAS Level** - –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –±–æ–ª–∏ (0-10)
- **Critical Cases** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–ª—É—á–∞–∏ (VAS >= 7)

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- **Total Recommendations** - –í—Å–µ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
- **Approved** - –û–¥–æ–±—Ä–µ–Ω–æ
- **Rejected** - –û—Ç–∫–ª–æ–Ω–µ–Ω–æ
- **Approval Rate** - –ü—Ä–æ—Ü–µ–Ω—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–π
- **Total Escalations** - –í—Å–µ–≥–æ —ç—Å–∫–∞–ª–∞—Ü–∏–π
- **Resolved** - –†–∞–∑—Ä–µ—à–µ–Ω–æ
- **Pending** - –í –æ–∂–∏–¥–∞–Ω–∏–∏
- **Avg Resolution Time** - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (—á–∞—Å—ã)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã
- **Avg Processing Time** - –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–º—Å)
- **Total Operations** - –í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π
- **Failed Operations** - –ù–µ—É–¥–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Total Logins** - –í—Å–µ–≥–æ –≤—Ö–æ–¥–æ–≤
- **Unique Active Users** - –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **Failed Login Attempts** - –ù–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Email (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `application.properties`:
```properties
spring.mail.host=smtp.gmail.com
spring.mail.username=your-email@gmail.com
spring.mail.password=your-app-password
```

### 2. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
mvn spring-boot:run
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è

```bash
curl http://localhost:8080/api/reports/health
```

### 4. –†—É—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞

```bash
curl -X POST "http://localhost:8080/api/reports/daily/generate?date=2025-10-18"
```

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–∞

```bash
curl http://localhost:8080/api/reports/daily/2025-10-18
```

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –û—Ç—á–µ—Ç—ã –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `@EnableScheduling` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `AsyncConfig.java`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –≤ 00:30

### –ü—Ä–æ–±–ª–µ–º–∞: Email –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `application.properties`
- –î–ª—è Gmail: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ App Password, –∞ –Ω–µ –æ–±—ã—á–Ω—ã–π –ø–∞—Ä–æ–ª—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ `MessagingException`

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –≤ PDF/Excel

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Apache POI –∏ PDFBox –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ `pom.xml`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ—Ç—á–µ—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `yyyy-MM-dd`
- –í—Å–µ –≤—Ä–µ–º–µ–Ω–∞ –≤ UTC
- Email –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç API)
- –≠–∫—Å–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π (–±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)
- MongoDB —Å–æ–±—ã—Ç–∏—è —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 30 –¥–Ω–µ–π
