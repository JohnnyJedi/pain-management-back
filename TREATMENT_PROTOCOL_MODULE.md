üß† Treatment Protocol Workflow Documentation
(Workflow README –¥–ª—è backend-–º–æ–¥—É–ª—è treatment_protocol)

1. –û–±—â–∞—è –∏–¥–µ—è –º–æ–¥—É–ª—è

–ú–æ–¥—É–ª—å Treatment Protocol –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (–ª–µ–∫–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–π) –Ω–∞ –æ—Å–Ω–æ–≤–µ:
—Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ª–µ—á–µ–Ω–∏—è (–∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ –∏–∑ Excel-—Ñ–∞–π–ª–∞);
–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ü–∏–µ–Ω—Ç–∞;
–Ω–∞–±–æ—Ä–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤-–∞–ø–ø–ª–∏–∫–∞—Ç–æ—Ä–æ–≤ (TreatmentRuleApplier), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—à–∞–≥–æ–≤–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–∞.

–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å:
–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–∞ (–≤–æ–∑—Ä–∞—Å—Ç, –≤–µ—Å, –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –∫—Ä–æ–≤–∏, –ø–µ—á–µ–Ω—å, –ø–æ—á–∫–∏, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –¥–∏–∞–≥–Ω–æ–∑—ã) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–æ–±—Ä–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ö–µ–º—É –ª–µ—á–µ–Ω–∏—è –∏–∑ –±–∞–∑—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤, —Å–æ–±–ª—é–¥–∞—è –≤—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è.

2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–ª–æ–∫–∞
   2.1 –ì–ª–∞–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   –ö–æ–º–ø–æ–Ω–µ–Ω—Ç	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
   TreatmentProtocolLoader	–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É Excel treatment_protocol.xlsx –≤ —Ç–∞–±–ª–∏—Ü—É –ë–î treatment_protocol –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
   TreatmentProtocol (Entity)	JPA-—Å—É—â–Ω–æ—Å—Ç—å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∏–∑ Excel-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞. –ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω –±–æ–ª–∏ (VAS) –∏ –ø–∞—Ä—É –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ (–æ—Å–Ω–æ–≤–Ω–æ–π + –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π) —Å –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.
   TreatmentProtocolRepository	–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Spring Data –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.
   TreatmentProtocolService	–ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä. –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –ø–æ —É—Ä–æ–≤–Ω—é –±–æ–ª–∏ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã (TreatmentRuleApplier).
   TreatmentRuleApplier (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)	–ö–æ–Ω—Ç—Ä–∞–∫—Ç –¥–ª—è –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤-–ø—Ä–∞–≤–∏–ª. –ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (–≤–æ–∑—Ä–∞—Å—Ç, GFR, PLT –∏ —Ç.–¥.)
   *.RuleApplier (10 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π)	–ö–ª–∞—Å—Å—ã, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏. –†–∞–±–æ—Ç–∞—é—Ç –≤ —Ü–µ–ø–æ—á–∫–µ @Order(1..10).

3. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã (workflow)
   3.1 –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Spring –∑–∞–ø—É—Å–∫–∞–µ—Ç TreatmentProtocolLoader.
–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª treatment_protocol.xlsx –∏–∑ resources/ –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –µ–≥–æ –≤ —Ç–∞–±–ª–∏—Ü—É –ë–î.
–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ Excel ‚Üí –æ–±—ä–µ–∫—Ç TreatmentProtocol.
–ö–æ–ª–æ–Ω–∫–∏ Excel —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–æ–ª—è–º —Å—É—â–Ω–æ—Å—Ç–∏ (painLevel, firstDrug, GFR, WBC –∏ —Ç.–¥.).
–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–æ–æ–±—â–∞–µ—Ç:
Treatment protocol table successfully loaded and sanitized.

3.2 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
–ü—Ä–æ—Ü–µ—Å—Å —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å–æ–º TreatmentProtocolService:

–®–∞–≥ 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –ø–æ —É—Ä–æ–≤–Ω—é –±–æ–ª–∏
–ò–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã treatment_protocol.
–û—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω painLevel (–Ω–∞–ø—Ä–∏–º–µ—Ä 4‚Äì6) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É—Ä–æ–≤–Ω—é –±–æ–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (vas.getPainLevel()).

–®–∞–≥ 2. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ Recommendation
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –æ–±—ä–µ–∫—Ç Recommendation.
–í –Ω—ë–º —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –¥–≤–µ –∑–∞–ø–∏—Å–∏ —Ç–∏–ø–∞ DrugRecommendation:
MAIN ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–µ–ø–∞—Ä–∞—Ç,
ALTERNATIVE ‚Äî –∑–∞–ø–∞—Å–Ω–æ–π.

–®–∞–≥ 3. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤-–∞–ø–ø–ª–∏–∫–∞—Ç–æ—Ä–æ–≤
–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∫–ª–∞—Å—Å—ã, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–µ TreatmentRuleApplier, –≤ –ø–æ—Ä—è–¥–∫–µ @Order(1..10).
–ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä –ø–æ–ª—É—á–∞–µ—Ç:
apply(DrugRecommendation drug, Recommendation recommendation, TreatmentProtocol tp, Patient patient)

–§–∏–ª—å—Ç—Ä –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
–∏–∑–º–µ–Ω—è–µ—Ç –¥–æ–∑–∏—Ä–æ–≤–∫—É/–∏–Ω—Ç–µ—Ä–≤–∞–ª;
–¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ recommendation.comments;
–ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç (—á–µ—Ä–µ–∑ DrugUtils.clearDrug()).

–ó–∞–ø—É—Å–∫ pipeline ‚Äî —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ –ø–æ—Ä—è–¥–∫—É @Order
–¢–µ–ø–µ—Ä—å –≤—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–∞–±–æ—Ç—É  —Ü–µ–ø–Ω–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä (List<TreatmentRuleApplier>).
Spring –ø–µ—Ä–µ–¥–∞—ë—Ç drug, recommendation, tp, patient –≤ –∫–∞–∂–¥—ã–π apply() –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

üîÑ –ü–æ–¥—Ä–æ–±–Ω–æ ‚Äî –∫–∞–∫ —Ñ–∏–ª—å—Ç—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç
üîπ [1] PainTrendRuleApplier (–µ—Å–ª–∏ —Å—Ç–æ–∏—Ç –≤ –Ω–∞—á–∞–ª–µ)
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –±–æ–ª–∏ (VAS) ‚Äî —Ä–∞—Å—Ç—ë—Ç –ª–∏ –∏–ª–∏ —Å–∫–∞—á–µ—Ç.
–ï—Å–ª–∏ —É—Ö—É–¥—à–∞–µ—Ç—Å—è –∏–ª–∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ:
DrugUtils.clearDrug(drug);
recommendation.getComments().add("[SYSTEM] Recommendation stopped: pain trend worsening or unstable.");
return;
‚û°Ô∏è –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è —É–∂–µ ‚Äú–ø—É—Å—Ç–∞‚Äù ‚Äî –¥–∞–ª—å—à–µ –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞.
üîπ [2] AgeRuleApplier
–ü–µ—Ä–≤—ã–π ‚Äú–Ω–∞—Å—Ç–æ—è—â–∏–π‚Äù —Ñ–∏–ª—å—Ç—Ä, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π –ø—Ä–µ–ø–∞—Ä–∞—Ç.
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
–ë–µ—Ä—ë—Ç –≤–æ–∑—Ä–∞—Å—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞ patient.getAge().
–°–º–æ—Ç—Ä–∏—Ç tp.getFirstAgeAdjustments() / tp.getSecondAgeAdjustments().
–ï—Å–ª–∏ NA –∏–ª–∏ –ø—É—Å—Ç–æ ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:
drug.setDrugName(tp.getFirstDrug());
drug.setActiveMoiety(tp.getFirstDrugActiveMoiety());
...
–ï—Å–ª–∏ –≤–æ–∑—Ä–∞—Å—Ç –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ ‚Üí
–¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: recommendation.getComments().add("System: First drug avoid: patient age (82) > 75");
–∏ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç fillDrugFromProtocol(), —Ç–æ –µ—Å—Ç—å drug –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º (–æ–±–Ω—É–ª—ë–Ω–Ω—ã–º).
–í–∞–∂–Ω–æ:
DrugUtils.hasInfo(drug) —Ç–µ–ø–µ—Ä—å –≤–µ—Ä–Ω—ë—Ç false –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞,
–∏ –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –µ–≥–æ –ø—Ä–æ–ø—É—Å—Ç—è—Ç.

üîπ [3] ContraindicationsRuleApplier
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –µ—Å—Ç—å –ª–∏ –¥–∏–∞–≥–Ω–æ–∑—ã –≤ EMR, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–µ—â–∞—é—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç.
–ü—Ä–æ–≤–µ—Ä–∫–∞:
–ï—Å–ª–∏ !DrugUtils.hasInfo(drug) ‚Üí return;(—Ç–æ –µ—Å—Ç—å –µ—Å–ª–∏ –≤–æ–∑—Ä–∞—Å—Ç —É–∂–µ ‚Äú–æ–±–Ω—É–ª–∏–ª‚Äù –ø—Ä–µ–ø–∞—Ä–∞—Ç ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç).
–ò–Ω–∞—á–µ –±–µ—Ä—ë—Ç patient.getEmr().getLast().getDiagnoses(),
—Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç ICD –∫–æ–¥ –∫–∞–∂–¥–æ–≥–æ –¥–∏–∞–≥–Ω–æ–∑–∞ —Å tp.getContraindications():
571.2  ‚Üî  571.201 OR 571.501
–ï—Å–ª–∏ –±–∞–∑–æ–≤–∞—è —á–∞—Å—Ç—å —Å–æ–≤–ø–∞–ª–∞ ‚Üí
–æ—á–∏—â–∞–µ—Ç –æ–±–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞:
recommendation.getDrugs().forEach(DrugUtils::clearDrug);
recommendation.getComments().add("System: avoid for contraindications (match by base ICD)");
–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç return; ‚Äî –¥–∞–ª—å—à–µ –Ω–µ –∏–¥—ë—Ç.

üîπ [4] SensitivityRuleApplier

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–ª–ª–µ—Ä–≥–∏—é / —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∫ –≤–µ—â–µ—Å—Ç–≤–∞–º.
–ï—Å–ª–∏ drug –µ—Å—Ç—å (hasInfo = true) ‚Üí –±–µ—Ä—ë—Ç
patient.getEmr().getLast().getSensitivities() –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å
tp.getAvoidIfSensitivity() (–Ω–∞–ø—Ä–∏–º–µ—Ä "PARACETAMOL OR TRAMADOL").
–ü—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –æ—á–∏—â–∞–µ—Ç –æ–±–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.

üîπ [5‚Äì8] Blood / Electrolyte Filters (PLT, WBC, SAT, Sodium)
–≠—Ç–æ –ø—Ä–æ—Å—Ç—ã–µ "threshold filters".
–£ –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:
if (!DrugUtils.hasInfo(drug)) return;
if (patientValue < limit) {
recommendation.getDrugs().forEach(DrugUtils::clearDrug);
recommendation.getComments().add("System: avoid for ...");
}
–ö–∞–∂–¥—ã–π –∏–∑ –Ω–∏—Ö –º–æ–∂–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚Äú–∑–∞–≤–∞–ª–∏—Ç—å‚Äù —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é,
–µ—Å–ª–∏ —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø–ª–æ—Ö–æ–π –∞–Ω–∞–ª–∏–∑ –∫—Ä–æ–≤–∏, –Ω–∏–∑–∫–∞—è —Å–∞—Ç—É—Ä–∞—Ü–∏—è, –Ω–∞—Ç—Ä–∏–π –∏ —Ç.–¥.

üîπ [9] ChildPughApplier
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –¥–æ–∑—É –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å –ø–µ—á—ë–Ω–æ—á–Ω–æ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å—é.
–ï—Å–ª–∏ drug –Ω–µ –æ–±–Ω—É–ª—ë–Ω —Ä–∞–Ω–µ–µ, —Å–º–æ—Ç—Ä–∏—Ç tp.getFirstChildPugh(), –Ω–∞–ø—Ä–∏–º–µ—Ä:
A - 50mg 8h B - 25mg 12h C - avoid
–î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞ (A|B|C) –Ω–∞—Ö–æ–¥–∏—Ç –ø—Ä–∞–≤–∏–ª–æ.
–ï—Å–ª–∏ ‚Äúavoid‚Äù ‚Üí –æ—á–∏—â–∞–µ—Ç drug.
–ï—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç ‚Äúmg‚Äù –∏–ª–∏ ‚Äúh‚Äù ‚Üí –º–µ–Ω—è–µ—Ç –¥–æ–∑—É –∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª.

üîπ [10] GfrRuleApplier
–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—á–µ–∫.
–ï—Å–ª–∏ avoid ‚Üí –æ—á–∏—â–∞–µ—Ç –æ–±–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞.
–ï—Å–ª–∏ ‚Äúreduce by 50%‚Äù ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –¥–æ–∑—É –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç.
–ï—Å–ª–∏ ‚Äú8h‚Äù –∏–ª–∏ ‚Äú12h‚Äù ‚Üí –º–µ–Ω—è–µ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª.

üîπ [11] WeightRuleApplier
–ü–æ—Å–ª–µ–¥–Ω—è—è –∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞.
–ï—Å–ª–∏ –≤–µ—Å < 50 –∫–≥ ‚Äî –º–µ–Ω—è–µ—Ç –¥–æ–∑—É –∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª.
–ï—Å–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ (–æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–µ) ‚Äî –ª–æ–≥–∏—Ä—É–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.

üîπ [12] PainTrendRuleApplier (–µ—Å–ª–∏ —Å—Ç–æ–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–º)

–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π ‚Äúwatchdog‚Äù.
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –Ω–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è –ª–∏ –±–æ–ª—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏.
–ï—Å–ª–∏ –¥–∞ ‚Äî –æ—á–∏—â–∞–µ—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:

[SYSTEM] Recommendation stopped: pain trend worsening or unstable. VAS history=[7, 6, 7]

–®–∞–≥ 4. –°–±–æ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –ø—Ä–µ–ø–∞—Ä–∞—Ç –æ—Å—Ç–∞–ª—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∏—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫.


–®–∞–≥ 5. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö (List<Recommendation>).

4.. –¶–µ–ø–æ—á–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (TreatmentRuleApplier)
‚Ññ	–ö–ª–∞—Å—Å	                         –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å	                               –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
0	PainTrendRuleApplier	         –î–∏–Ω–∞–º–∏–∫–∞ –±–æ–ª–∏ (VAS)	                   –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∂–∞–ª–æ–±—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ –±–æ–ª—å —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è (—Ä–µ–≥—Ä–µ—Å—Å–∏—Ä—É–µ—Ç) –∏–ª–∏ —Å–∫–∞—á–µ—Ç –±–µ–∑ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø—Ä–µ–∫—Ä–∞—â–∞–µ—Ç—Å—è, –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –æ—á–∏—â–∞—é—Ç—Å—è, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.(–¥–µ–π—Å—Ç–≤—É–µ—Ç –ª–∏—à—å –Ω–∞ 3-—é—é –∂–∞–ª–æ–±—É –ø–æ–¥—Ä—è–¥)
1	AgeRuleApplier	                 –í–æ–∑—Ä–∞—Å—Ç –ø–∞—Ü–∏–µ–Ω—Ç–∞	                       –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –ï—Å–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç < 18 –ª–µ—Ç –∏–ª–∏ > 75 –ª–µ—Ç ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏–ª–∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è. (–ì–ª–∞–≤–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä —Å–æ–∑–¥–∞—é—â–∏–π –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–≤–∞ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞)
2	ContraindicationsRuleApplier	 –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è –ø–æ –¥–∏–∞–≥–Ω–æ–∑–∞–º (ICD-–∫–æ–¥—ã)  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–∏–∞–≥–Ω–æ–∑—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞ –ø–æ ICD-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É. –ï—Å–ª–∏ –∫–æ–¥ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏–µ–º –∏–∑ Treatment Protocol ‚Äî –≤—Å–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è.
3	SensitivityRuleApplier	         –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å	       –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ø–∏—Å–æ–∫ –≤–µ—â–µ—Å—Ç–≤, —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ AvoidIfSensitivity. –ï—Å–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç –∞–ª–ª–µ—Ä–≥–∏—é –Ω–∞ –æ–¥–Ω–æ –∏–∑ –Ω–∏—Ö ‚Äî –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è.

4	PltRuleApplier	                 –¢—Ä–æ–º–±–æ—Ü–∏—Ç—ã (PLT)	                       –ï—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–æ–º–±–æ—Ü–∏—Ç–æ–≤ –Ω–∏–∂–µ 100 K/¬µL ‚Äî –≤—Å–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è (—Ä–∏—Å–∫ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è).
5	WbcRuleApplier	                 –õ–µ–π–∫–æ—Ü–∏—Ç—ã (WBC)	                       –ï—Å–ª–∏ WBC < 4.0 √ó 10¬≥/¬µL ‚Äî –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è (—Ä–∏—Å–∫ –∏–Ω—Ñ–µ–∫—Ü–∏–π).
6	SatRuleApplier	                 –°–∞—Ç—É—Ä–∞—Ü–∏—è (SpO‚ÇÇ)	                       –ï—Å–ª–∏ –Ω–∞—Å—ã—â–µ–Ω–∏–µ –∫—Ä–æ–≤–∏ –∫–∏—Å–ª–æ—Ä–æ–¥–æ–º < 93 % ‚Äî –≤—Å–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è.
7	SodiumRuleApplier	             –ù–∞—Ç—Ä–∏–π (Na‚Å∫)	                           –ï—Å–ª–∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è Na‚Å∫ < 130 mEq/L ‚Äî –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è (–≥–∏–ø–æ–Ω–∞—Ç—Ä–∏–µ–º–∏—è).
9	WeightRuleApplier	             –í–µ—Å –ø–∞—Ü–∏–µ–Ω—Ç–∞	                           –ï—Å–ª–∏ –≤–µ—Å < 50 –∫–≥ ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –¥–æ–∑—É (mg) –∏–ª–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–∏—ë–º–∞ (h) –ø–æ –¥–∞–Ω–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.
10	ChildPughApplier	             –ü–µ—á—ë–Ω–æ—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è (Child-Pugh A/B/C)	   –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–æ A-50 mg 8h, B-25 mg 12h, C-avoid. –î–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏–∑–º–µ–Ω—è–µ—Ç –¥–æ–∑—É –∏–ª–∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç.
11	GfrRuleApplier	                 –ü–æ—á–µ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (GFR)	               –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã Class B - 12h –∏–ª–∏ <60 ml/min - avoid. –ú–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ–∑—É, –∏–∑–º–µ–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –∏–ª–∏ –∏—Å–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç –ø—Ä–∏ –Ω–∏–∑–∫–æ–º GFR.

üß© –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
–ü–µ—Ä–≤—ã–µ —Å–µ–º—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Äî ‚Äúfail-fast‚Äù, –æ–Ω–∏ –º–æ–≥—É—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–ª—å–Ω–µ–π—à–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.
–ü–æ—Å–ª–µ–¥–Ω–∏–µ —á–µ—Ç—ã—Ä–µ ‚Äî ‚Äúcorrective‚Äù, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç –¥–æ–ø—É—â–µ–Ω –∫ —Ç–µ—Ä–∞–ø–∏–∏, –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ç–æ—á–Ω—É—é –¥–æ–∑–æ–≤—É—é –∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é.
–¢–∞–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π,
—Ä–µ–∞–ª–∏–∑—É—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—é Fail Fast ‚Äî Correct Late –∏ —Å–æ–∫—Ä–∞—â–∞—è –≤—Ä–µ–º—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –¥–æ –¥–æ–ª–µ–π –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤.

5. –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
–ö–∞–∂–¥—ã–π —Ñ–∏–ª—å—Ç—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ–ª—è –∏–∑ —Å—É—â–Ω–æ—Å—Ç–µ–π Patient –∏ Emr:


–ü–æ–ª–µ	–ò—Å—Ç–æ—á–Ω–∏–∫	–ü—Ä–∏–º–µ—Ä –∑–Ω–∞—á–µ–Ω–∏—è
age	patient.getAge()	35
weight	patient.getEmr().getLast().getWeight()	77
childPughScore	patient.getEmr().getLast().getChildPughScore()	"A"
gfr	patient.getEmr().getLast().getGfr()	"133" –∏–ª–∏ "A"
plt	patient.getEmr().getLast().getPlt()	333
wbc	patient.getEmr().getLast().getWbc()	7
sat	patient.getEmr().getLast().getSat()	94
sodium	patient.getEmr().getLast().getSodium()	133
sensitivities	patient.getEmr().getLast().getSensitivities()	["TRAMADOL"]
diagnoses	patient.getEmr().getLast().getDiagnoses()	[Diagnosis("Alcoholic cirrhosis", "571.21")]

6. –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∏–ª—å—Ç—Ä –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ:
–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π TreatmentRuleApplier.
–î–æ–±–∞–≤–∏—Ç—å –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏:
@Component
@Order(11)
–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ apply(...) —Å –ª–æ–≥–∏–∫–æ–π.
Spring –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç —Ñ–∏–ª—å—Ç—Ä –≤ —Å–ø–∏—Å–æ–∫ ruleAppliers –≤–Ω—É—Ç—Ä–∏ TreatmentProtocolService.



7. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ICD-–¥–∏–∞–≥–Ω–æ–∑–∞–º–∏ (–º–∏–Ω–∏-–º–æ–¥—É–ª—å icd_diagnosis)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
   üìò –û–±—â–∞—è –∏–¥–µ—è

–ü–æ–¥–º–æ–¥—É–ª—å icd_diagnosis –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ–∏—Å–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –ø–æ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ICD-9 (–∏–ª–∏ ICD-10).
–ï–≥–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî –¥–∞—Ç—å —Å–∏—Å—Ç–µ–º–µ –±—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–±:
—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–¥–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π (–æ–∫–æ–ª–æ 75 000 —Å—Ç—Ä–æ–∫),
–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ (–ø–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é),
–ø–æ–∑–≤–æ–ª—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—É ContraindicationsRuleApplier —Å–≤–µ—Ä—è—Ç—å –¥–∏–∞–≥–Ω–æ–∑—ã –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ –∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ª–µ—á–µ–Ω–∏—è.
–≠—Ç–æ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫, –ø–æ—ç—Ç–æ–º—É –æ–Ω —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑: Entity + Repository + Loader + Controller, –±–µ–∑ @Service-—Å–ª–æ—è ‚Äî –ø–æ—Å–∫–æ–ª—å–∫—É –Ω–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –∫—Ä–æ–º–µ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∑–¥–µ—Å—å –Ω–µ—Ç.
‚öôÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
     –ö–æ–º–ø–æ–Ω–µ–Ω—Ç	                –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
IcdDictionaryLoader  	–ó–∞–≥—Ä—É–∂–∞–µ—Ç CSV-—Ñ–∞–π–ª icd9cm_2015_converted.csv –∏–∑ resources/ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–¥—ã ICD-9 –≤ –ë–î.
IcdDictionary (Entity)	–°—É—â–Ω–æ—Å—Ç—å JPA: —Ö—Ä–∞–Ω–∏—Ç –∫–æ–¥ –±–æ–ª–µ–∑–Ω–∏ (code) –∏ –æ–ø–∏—Å–∞–Ω–∏–µ (description).
IcdDictionaryRepository	–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å Spring Data JPA –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –∫–æ–¥—É –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é.
IcdDictionaryController	REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä /api/icd, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π —ç–Ω–¥–ø–æ–∏–Ω—Ç /search?query=... –¥–ª—è –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –¥–∏–∞–≥–Ω–æ–∑–æ–≤.
üß© –î–µ—Ç–∞–ª—å–Ω—ã–π Workflow
1Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∫–∞ ICD-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ Spring-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è IcdDictionaryLoader (—á–µ—Ä–µ–∑ CommandLineRunner).
–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ icd_dictionary –ø—É—Å—Ç–∞ ‚Üí –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞ icd9cm_2015_converted.csv.
–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏:code ‚Äî –∫–æ–¥ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä 571.21 –∏–ª–∏ 250.00), description ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä Alcoholic cirrhosis of liver without ascites).
–§–∞–π–ª —á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ, —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –æ–±—ä–µ–∫—Ç—ã IcdDictionary, –∫–æ—Ç–æ—Ä—ã–µ –ø–∞—á–∫–∞–º–∏ –ø–æ 1000 –∑–∞–ø–∏—Å–µ–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î.
üí° –ó–¥–µ—Å—å –Ω–µ—Ç —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏ –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤ –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ Treatment Protocol —Ç–∞–±–ª–∏—Ü—ã ‚Äî —Ç–æ–ª—å–∫–æ –ø–∞—Ä–∞ ¬´–∫–æ–¥ ‚Äì –æ–ø–∏—Å–∞–Ω–∏–µ¬ª.
–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–æ–∏—Å–∫–∞.
2Ô∏è‚É£ REST-—ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä IcdDictionaryController –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ–∏—Å–∫ –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞:GET /api/icd/search?query=diab - 
–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 20 —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, –≥–¥–µ description —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥—Å—Ç—Ä–æ–∫—É diab (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª—è ¬´–î–∏–∞–≥–Ω–æ–∑¬ª –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ EMR.
–§—Ä–æ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç JSON-–º–∞—Å—Å–∏–≤:
[
{"icdCode":"250.00","description":"Diabetes mellitus without mention of complication"},
{"icdCode":"250.01","description":"Type 1 diabetes mellitus without complications"}
]
3Ô∏è‚É£ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–æ–º ContraindicationsRuleApplier
–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä –ø–æ–ª—É—á–∞–µ—Ç —É –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å–ø–∏—Å–æ–∫ –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏ EMR:patient.getEmr().getLast().getDiagnoses()
–ö–∞–∂–¥—ã–π –¥–∏–∞–≥–Ω–æ–∑ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ ICD (–Ω–∞–ø—Ä–∏–º–µ—Ä 571.21).
–§–∏–ª—å—Ç—Ä –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Å—Ç—Ä–æ–∫—É contraindications –∏–∑ TreatmentProtocol –∏ —Ä–∞–∑–±–∏—Ä–∞–µ—Ç –≤—Å–µ ICD-–∫–æ–¥—ã —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–∫—É:[A-Z]?[0-9]{3}(?:\.[0-9A-Z]+)?
–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –∫–æ–¥–æ–≤—ã—Ö –¥–∏–∞–≥–Ω–æ–∑–æ–≤ –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–¥–æ–º –∏–∑ —Å—Ç—Ä–æ–∫–∏ contraindications, –ø—Ä–µ–ø–∞—Ä–∞—Ç –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è:DrugUtils.clearDrug(drug);
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, icd_diagnosis –º–æ–¥—É–ª—å —Å–ª—É–∂–∏—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º —Ä–µ–µ—Å—Ç—Ä–æ–º –∫–æ–¥–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏–π.

4Ô∏è‚É£ –ü–æ—á–µ–º—É –∑–¥–µ—Å—å –Ω–µ—Ç Service-—Å–ª–æ—è
–ú–æ–¥—É–ª—å –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø–æ–∏—Å–∫.
–í—Å—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å ICD-–∫–æ–¥–∞–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–∏–±–æ:
–≤ IcdDictionaryLoader (–æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è),
–ª–∏–±–æ –≤ ContraindicationsRuleApplier (—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è),
–ª–∏–±–æ –≤ REST-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ (–ø–æ–∏—Å–∫ –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é).
–ü–æ—ç—Ç–æ–º—É —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ IcdDictionaryService –∏–∑–±—ã—Ç–æ—á–Ω–æ: –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

8. –ü—Ä–∏–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
1Ô∏è‚É£ –ü–∞—Ü–∏–µ–Ω—Ç –∏–º–µ–µ—Ç:
–≤–æ–∑—Ä–∞—Å—Ç 35 –ª–µ—Ç
–≤–µ—Å 77 –∫–≥
GFR = 133
Child-Pugh A
PLT 333, WBC 7
SAT 94 %, Sodium 133
–Ω–µ—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–µ—Ç –¥–∏–∞–≥–Ω–æ–∑–æ–≤
2Ô∏è‚É£ –í—ã–∑–æ–≤:
treatmentProtocolService.generateRecommendation(vas, patient);
3Ô∏è‚É£ –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ painLevel, –Ω–∞—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω—ã–π TreatmentProtocol.
4Ô∏è‚É£ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –≤—Å–µ 10 —Ñ–∏–ª—å—Ç—Ä–æ–≤.
5Ô∏è‚É£ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é Recommendation:
{
"status": "PENDING",
"drugs": [
{"role":"MAIN","activeMoiety":"PARACETAMOL","dosing":"500 mg","interval":"8h"},
{"role":"ALTERNATIVE","activeMoiety":"TRAMADOL","dosing":"50 mg","interval":"12h"}
],
"comments": [],
"contraindications": []
}
9. –¢–∞–±–ª–∏—Ü–∞ –Ω–æ—Ä–º –∏ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è
   –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å	–ê–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞	–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è	–ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω
   –í–æ–∑—Ä–∞—Å—Ç	‚Äî	–ª–µ—Ç	‚Äî
   –í–µ—Å	kg	–∫–∏–ª–æ–≥—Ä–∞–º–º—ã	> 50 –∫–≥
   Child-Pugh	‚Äî	–ö–ª–∞—Å—Å A‚ÄìC	A ‚Äì –Ω–æ—Ä–º–∞, B ‚Äì —É–º–µ—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è, C ‚Äì —Ç—è–∂—ë–ª—ã–µ
   –ü–æ—á–µ—á–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (GFR)	ml/min	–º–ª/–º–∏–Ω	‚â• 90 (Class A)
   –¢—Ä–æ–º–±–æ—Ü–∏—Ç—ã (PLT)	K/¬µL	—Ç—ã—Å—è—á–∏/–º–∫–ª	150 ‚Äì 450
   –õ–µ–π–∫–æ—Ü–∏—Ç—ã (WBC)	√ó10¬≥/¬µL	10¬≥ –∫–ª–µ—Ç–æ–∫/–º–∫–ª	4.0 ‚Äì 10.0
   –°–∞—Ç—É—Ä–∞—Ü–∏—è (SpO‚ÇÇ)	%	–ø—Ä–æ—Ü–µ–Ω—Ç—ã	95 ‚Äì 100 %
   –ù–∞—Ç—Ä–∏–π (Na‚Å∫)	mEq/L	–º–∏–ª–ª–∏—ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç—ã/–ª	135 ‚Äì 145
   –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å	‚Äî	—Å–ø–∏—Å–æ–∫ –≤–µ—â–µ—Å—Ç–≤	–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è (ICD-codes)	ICD-9 / ICD-10	–∫–æ–¥ –±–æ–ª–µ–∑–Ω–∏	–æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
10. –†–µ–∑—é–º–µ
–ú–æ–¥—É–ª—å Treatment Protocol ‚Äî —ç—Ç–æ:
–Ω–∞–¥—ë–∂–Ω—ã–π –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π;
—Ü–µ–ø–æ—á–∫–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É –∫–ª–∏–Ω–∏—á–µ—Å–∫—É—é –ª–æ–≥–∏–∫—É;
–≥–∏–±–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –ª—é–±—ã–µ –Ω–æ–≤—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏;
–ø—Ä–æ—Å—Ç–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ –∏ ICD-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤.

